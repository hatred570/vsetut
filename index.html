<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ Telegram</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            color: #333;
            margin: 0;
            padding: 0;
        }
        #loading {
            display: block;
            font-size: 20px;
            margin-top: 20px;
        }
        #message {
            display: none;
            font-size: 18px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="loading">
        –ü–æ–¥–æ–∂–¥–∏—Ç–µ, –∏–¥—ë—Ç –∑–∞–≥—Ä—É–∑–∫–∞...
    </div>
    <div id="message"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // üõë –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–ª–∏ –Ω–µ –≤ Telegram
            if (!window.Telegram || !Telegram.WebApp) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ –≤ Telegram
                document.body.innerHTML = `
                    <div style="color:#777;font-family:sans-serif;text-align:center">
                        –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–Ω—É—Ç—Ä–∏ Telegram
                    </div>
                `;
                return;
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();

            const VALID_KEY = 'bozz1';
            const BOT_LINK = 'https://t.me/diavozbuczulolzodbot';
            const REDIRECT_FLAG = 'redirect_done';

            const loading = document.getElementById('loading');
            const message = document.getElementById('message');

            const startParam = Telegram.WebApp.initDataUnsafe?.start_param;

            // –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
            if (sessionStorage.getItem(REDIRECT_FLAG)) {
                loading.style.display = 'none';
                message.style.display = 'block';
                message.innerText = '–ì–æ—Ç–æ–≤–æ';
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–ª—é—á
            if (startParam === VALID_KEY) {
                sessionStorage.setItem(REDIRECT_FLAG, '1');

                // –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                loading.style.display = 'none';
                message.style.display = 'block';
                message.innerText = '–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...';

                // –ü—Ä–æ–±—É–µ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ —Å—Å—ã–ª–∫—É —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π window.location
                setTimeout(() => {
                    window.location.href = BOT_LINK;
                }, 300);
            } else {
                loading.style.display = 'none';
                message.style.display = 'block';
                message.innerText = '–í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
            }
        });
    </script>
</body>
</html>
